"use strict";function getLocation(){var e=document.getElementById("city").value,o=document.getElementById("address").value,r="".concat(o,", ").concat(e),a="https://nominatim.openstreetmap.org/search?q=".concat(encodeURIComponent(r),"&format=json&limit=1");fetch(a).then(function(e){return e.json()}).then(function(e){if(e&&0<e.length){var o=e[0],r=o.lat,a=o.lon;document.getElementById("location").value="Latitude: ".concat(r,", Longitude: ").concat(a)}else console.error("Geocoding failed: No results found"),alert("Unable to retrieve location. Please check the address and city name.")}).catch(function(e){console.error("Error fetching geocode:",e),alert("Unable to retrieve location. Please try again later.")})}function handleMadical(){var e=document.getElementById("medicalModel");if(e){var o=e.querySelector("#campusName").value,r=e.querySelector("#healthStatus").value,a=e.querySelector("#location").value,t=e.querySelector("#city").value,s=a.split(",");postMedicalData(o,r,s[0]?s[0].replace("Latitude: ","").trim():"Not Available",s[1]?s[1].replace("Longitude: ","").trim():"Not Available",t)}}function postMedicalData(e,o,r,a,t){showLoader();var s=new URLSearchParams(window.location.search).get("userID");$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"postMedicalData",campus:e,longitude:a,latitude:r,userID:s,city:t,status:o},success:function(e){hideLoader(),e.success?(hideMedical(),showMessageModel()):(alert(e.message),hideMedical()),location.reload()},error:function(e){console.error("Error response:",e.responseText),hideLoader()}})}function handleSecurity(){var e=document.getElementById("securityModel");if(e){var o=e.querySelector("#campusName").value,r=e.querySelector("#securityType").value,a=e.querySelector("#location").value,t=e.querySelector("#city").value,s=a.split(",");postSecurityData(o,r,s[0]?s[0].replace("Latitude: ","").trim():"Not Available",s[1]?s[1].replace("Longitude: ","").trim():"Not Available",t)}}function postSecurityData(e,o,r,a,t){showLoader();var s=new URLSearchParams(window.location.search).get("userID");$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"postsecurityData",campus:e,longitude:a,latitude:r,userID:s,city:t,securityType:o},success:function(e){hideLoader(),e.success?(showMessageModel(),showMessageModel()):(alert(e.message),hideSecurtyMedical()),location.reload()},error:function(e){console.error("Error response:",e.responseText),hideLoader()}})}function handleFire(){var e=document.getElementById("fireModel");if(e){var o=e.querySelector("#campusName").value,r=e.querySelector("#location").value,a=e.querySelector("#city").value,t=r.split(",");postFireData(o,t[0]?t[0].replace("Latitude: ","").trim():"Not Available",t[1]?t[1].replace("Longitude: ","").trim():"Not Available",a)}}function postFireData(e,o,r,a){showLoader();var t=new URLSearchParams(window.location.search).get("userID");$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"postFireData",campus:e,longitude:r,latitude:o,city:a,userID:t},success:function(e){hideLoader(),e.success?(hideFireMedical(),showMessageModel()):(alert(e.message),hideFireMedical()),location.reload()},error:function(e){console.error("Error response:",e.responseText),hideLoader()}})}function showLoader(){document.getElementById("loader-overlay").style.display="block"}function hideLoader(){document.getElementById("loader-overlay").style.display="none"}function handleSignIn(){var e=document.getElementById("email").value.toLowerCase().trim(),o=document.getElementById("password").value.trim();""!==e?""!==o?login(e,o):alert("Password is required"):alert("Email is required")}function login(e,o){showLoader(),console.log("Attempting login with email:",e,"and password:",o),$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"login",email:e,password:o},success:function(e){if(hideLoader(),e.success){var o=e.user.userID,r=e.user.userType;"admin"===r?window.location.href="admin.html?userID="+o:"user"===r&&(window.location.href="main.html?userID="+o)}else alert("Login failed: "+e.message)},error:function(e,o,r){console.log("An error occurred: "+r),console.error("Error response:",e.responseText),hideLoader()}})}function handleRegister(){var e=document.getElementById("email").value.toLowerCase().trim(),o=document.getElementById("password").value.trim(),r=document.getElementById("confirmPassword").value.trim(),a=document.getElementById("fullName").value,t=document.getElementById("cellNumber").value.trim();if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)){if(/^0[6-8][0-9]{8}$/.test(t))if(o===r)if(""!==a){/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{6,}$/.test(o)?registerUsers(a,e,o,t):alert("Password must be at least 6 characters long, contain at least one uppercase letter, one lowercase letter, one number, and one special character")}else alert("Fullname is required");else alert("Password Dont Match");else alert("Please enter a valid South African phone number")}else alert("Please enter a valid email address")}function registerUsers(e,o,r,a){showLoader(),$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"registerUser",email:o,password:r,fullname:e,cellNumber:a},success:function(e){hideLoader(),console.log("the error :"+e),e.success?(alert(e.message),window.location.href="index.html"):alert(e.message)},error:function(e){console.error("Error response:",e.responseText),hideLoader()}})}function handleUpdatePassword(){var e=document.getElementById("email").value;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))return console.log("password: "+e),void alert("Please enter a valid email address");updatePassword(e)}function updatePassword(e){showLoader(),$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"updatePassword",email:e},success:function(e){hideLoader(),console.log(e),e.success?(alert(e.message),window.location.href="index.html"):alert(e.message)},error:function(e){console.error("Error response:",e.responseText),hideLoader()}})}function changeReadonly(){var e=document.querySelectorAll("input, textarea");btnUpdate=document.getElementById("update"),fullname=document.getElementById("fullname"),hiddenInputs=document.getElementById("hiddenInputs"),e.forEach(function(e){e.readOnly=!e.readOnly,e.readOnly?(e.style.borderBottom="none",btnUpdate.style.display="none",fullname.style.display="block",e.style.color="#3c3838",hiddenInputs.style.display="none",getUserData()):(e.style.borderBottom="1px solid black",e.style.color="#000",btnUpdate.style.display="block",fullname.style.display="none",hiddenInputs.style.display="block")})}function goToAccHtml(){var e=new URLSearchParams(window.location.search).get("userID");window.location.href="account.html?userID="+e}function goToMainHtml(){var e=new URLSearchParams(window.location.search).get("userID");window.location.href="main.html?userID="+e}function goToAccAdminHtml(){var e=new URLSearchParams(window.location.search).get("userID");window.location.href="adminAccount.html?userID="+e}function goToAdminHtml(){var e=new URLSearchParams(window.location.search).get("userID");window.location.href="admin.html?userID="+e}function getUserData(){showLoader();var e=new URLSearchParams(window.location.search).get("userID");$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{userID:e,function:"getUserData"},success:function(e){hideLoader(),e&&!1!==e.success?populateModalFields(e):console.error("Failed to get user data")},error:function(e){console.error("Error response:",e.responseText),hideLoader()}})}function populateModalFields(e){var o=e.data;document.querySelector("#email").value=o.email||"",document.querySelector("#fullname").value=o.fullname||"",document.querySelector("#cellNumber").value=o.cellNumber||""}function handleUpdateUser(){var e=document.getElementById("email").value.toLowerCase().trim(),o=document.getElementById("fullname").value,r=document.getElementById("cellNumber").value.trim();if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)){/^0[6-8][0-9]{8}$/.test(r)?""!==o?updateUserDetails(e,o,r):alert("Fullname is required"):alert("Please enter a valid South African phone number")}else alert("Please enter a valid email address")}function updateUserDetails(e,o,r){showLoader();var a=new URLSearchParams(window.location.search).get("userID");$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"updateUser",email:e,fullname:o,cellNumber:r,userID:a},success:function(e){hideLoader(),e.success?(alert(e.message),location.reload()):alert(e.message)},error:function(e){console.error("Error response:",e.responseText),hideLoader()}})}function getMedicalReports(){showLoader(),$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"medicalReports"},success:function(e){if(hideLoader(),console.log("response data:",e),e){var o="";e.forEach(function(e){o+=medicalDisplay(e.id,e.userID,e.campus,e.dateTime,e.status,e.city)}),$("#reports").html(o)}else $("#reports").html("No data found")},error:function(e){console.error("Error response:",e.responseText),hideLoader()}})}function getFireReports(){showLoader(),$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"fireReports"},success:function(e){if(hideLoader(),console.log("response data:",e),e){var o="";e.forEach(function(e){o+=fireDisplay(e.id,e.userID,e.campus,e.dateTime,e.city)}),$("#reports").html(o)}else $("#reports").html("No data found")},error:function(e){console.error("Error response:",e.responseText),hideLoader()}})}function getSecurityReports(){showLoader(),$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"securityReports"},success:function(e){if(hideLoader(),console.log("response data:",e),e){var o="";e.forEach(function(e){o+=securityDisplay(e.id,e.userID,e.campus,e.dateTime,e.securityType,e.city)}),$("#reports").html(o)}else $("#reports").html("No data found")},error:function(e){console.error("Error response:",e.responseText),hideLoader()}})}function medicalView(){showLoader();var e=new URLSearchParams(window.location.search).get("itemID");$.ajax({type:"POST",dataType:"json",url:"php/controller.php",data:{function:"medicalView",itemId:e},success:function(e){if(hideLoader(),e.success){var o=e.data;$("#campus").text(o.campus),$("#status").text(o.status),$("#date").text(o.dateTime),updateMapIframe(o.latitude,o.longitude,o.city)}else alert("Error \n"+e.message)},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})}function medicalViewsos(){showLoader();var e=new URLSearchParams(window.location.search).get("itemID");$.ajax({type:"POST",dataType:"json",url:"php/controller.php",data:{function:"medicalViewsos",itemId:e},success:function(e){if(hideLoader(),e.success){var o=e.data;$("#campus").text(o.campus),$("#status").text(o.status),$("#date").text(o.dateTime),updateMapIframe(o.latitude,o.longitude,o.city)}else alert("Error \n"+e.message)},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})}function securityView(){showLoader();var e=new URLSearchParams(window.location.search).get("itemID");$.ajax({type:"POST",dataType:"json",url:"php/controller.php",data:{function:"securityView",itemId:e},success:function(e){if(hideLoader(),e.success){var o=e.data;$("#campus").text(o.campus),$("#status").text(o.securityType),$("#date").text(o.dateTime),updateMapIframe(o.latitude,o.longitude,o.city)}else alert("Error \n"+e.message)},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})}function securityViewsos(){showLoader();var e=new URLSearchParams(window.location.search).get("itemID");$.ajax({type:"POST",dataType:"json",url:"php/controller.php",data:{function:"securityViewsos",itemId:e},success:function(e){if(hideLoader(),e.success){var o=e.data;$("#campus").text(o.campus),$("#status").text(o.securityType),$("#date").text(o.dateTime),updateMapIframe(o.latitude,o.longitude,o.city)}else alert("Error \n"+e.message)},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})}function fireView(){showLoader();var e=new URLSearchParams(window.location.search).get("itemID");$.ajax({type:"POST",dataType:"json",url:"php/controller.php",data:{function:"fireView",itemId:e},success:function(e){if(hideLoader(),e.success){var o=e.data;$("#campus").text(o.campus),$("#date").text(o.dateTime),updateMapIframe(o.latitude,o.longitude)}else alert("Error \n"+e.message)},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})}function fireViewsos(){showLoader();var e=new URLSearchParams(window.location.search).get("itemID");$.ajax({type:"POST",dataType:"json",url:"php/controller.php",data:{function:"fireViewsos",itemId:e},success:function(e){if(hideLoader(),e.success){var o=e.data;$("#campus").text(o.campus),$("#date").text(o.dateTime),updateMapIframe(o.latitude,o.longitude)}else alert("Error \n"+e.message)},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})}function updateMapIframe(e,o){var r="https://www.google.com/maps?q=".concat(e,",").concat(o,"&hl=es;z=14&output=embed");document.getElementById("mapIframe").src=r}function medicalViewUserData(){showLoader();var e=new URLSearchParams(window.location.search).get("userID");$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{userID:e,function:"getUserData"},success:function(e){if(hideLoader(),e.success){var o=e.data;$("#fullname").text(o.fullname),$("#cellNumber").text(o.cellNumber),$("#email").text(o.email)}else alert(e.message)},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})}function sosMedical(){showLoader();var a=new URLSearchParams(window.location.search).get("userID");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var o=e.coords.latitude,r=e.coords.longitude;$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{userID:a,latitude:o,longitude:r,function:"sosMedical"},success:function(e){hideLoader(),e.success?showMessageModel():alert(e.message)},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})},function(e){hideLoader(),console.error("Geolocation error: "+e.message),alert("Unable to retrieve your location. Please try again.")}):(hideLoader(),alert("Geolocation is not supported by your browser."))}function sosFire(){showLoader();var a=new URLSearchParams(window.location.search).get("userID");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var o=e.coords.latitude,r=e.coords.longitude;$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{userID:a,latitude:o,longitude:r,function:"sosFire"},success:function(e){hideLoader(),e.success?showMessageModel():alert(e.message)},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})},function(e){hideLoader(),console.error("Geolocation error: "+e.message),alert("Unable to retrieve your location. Please try again.")}):(hideLoader(),alert("Geolocation is not supported by your browser."))}function sosSecuriry(){showLoader();var a=new URLSearchParams(window.location.search).get("userID");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var o=e.coords.latitude,r=e.coords.longitude;$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{userID:a,latitude:o,longitude:r,function:"sosSecurity"},success:function(e){hideLoader(),e.success?showMessageModel():alert(e.message)},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})},function(e){hideLoader(),console.error("Geolocation error: "+e.message),alert("Unable to retrieve your location. Please try again.")}):(hideLoader(),alert("Geolocation is not supported by your browser."))}function getAllSOSReports(){showLoader(),$.ajax({type:"POST",url:"php/controller.php",dataType:"json",data:{function:"sosAllproducts"},success:function(e){if(hideLoader(),e.success){var o="",r=e.data;r.sosMedical&&Array.isArray(r.sosMedical)&&r.sosMedical.forEach(function(e){o+=sosMedicalDisplay(e.id,e.userID,e.dateTime,e.status)}),r.sosFire&&Array.isArray(r.sosFire)&&r.sosFire.forEach(function(e){o+=sosFireDisplay(e.id,e.userID,e.dateTime)}),r.sosSecurity&&Array.isArray(r.sosSecurity)&&r.sosSecurity.forEach(function(e){o+=sosSecurityDisplay(e.id,e.userID,e.dateTime,e.securityType)}),o?$("#reports").append(o):alert("No reports to display.")}else alert(e.message||"Failed to load reports.")},error:function(e,o){hideLoader(),console.log("An Error: "+o),console.error("Response Error: "+e.responseText)}})}
//# sourceMappingURL=main.min.js.map
